<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>renren-fast å‰åç«¯CRUDä»£ç ç”Ÿæˆå™¨ï¼ˆå¤šTabæ¨¡æ¿ç¼–è¾‘ç‰ˆï¼‰</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: sans-serif; line-height: 1.6; height: 100vh; overflow: hidden; }
        /* æ ¸å¿ƒï¼šå·¦å³ä¸¤æ å¼¹æ€§å¸ƒå±€ï¼Œå æ»¡è§†å£ */
        .layout-container { display: flex; width: 100vw; height: 100vh; gap: 1px; background: #e4e7ed; }
        .left-panel { flex: 1; padding: 20px; background: #fff; overflow-y: auto; height: 100%; }
        .right-panel { flex: 1; height: 100%; background: #f5f7fa; display: none; flex-direction: column; }
        /* åŸæœ‰æ ·å¼ä¿ç•™å¹¶é€‚é… */
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; margin-right: 10px; }
        button:disabled { cursor: not-allowed; opacity: 0.6; }
        .log, .dir-tree { background: #f4f4f4; padding: 10px; margin-top: 10px; border-radius: 4px; min-height: 50px; font-family: monospace; }
        .module-input, .tab-container, .name-rule { margin: 15px 0; }
        .module-input input { padding: 8px 12px; font-size: 16px; width: 300px; margin-left: 10px; }
        .name-rule, .tab-container { width: auto; margin: 10px 0; }
        .name-rule input, .tab-container input { width: auto; margin: 0 5px 0 20px; }
        label { font-weight: 500; }
        .dir-tree { min-height: 120px; white-space: pre; color: #333; line-height: 1.8; }
        .dir-tree-title { font-weight: bold; margin-bottom: 5px; color: #409EFF; }
        .generated { color: #67C23A; font-weight: 500; }
        .tip { color: #909399; font-size: 14px; margin-top: 5px; }
        /* å…¨å±€Tabåˆ‡æ¢æ ·å¼ï¼ˆå‰åç«¯+æ¨¡æ¿æ–‡ä»¶ï¼‰ */
        .tab-group { display: flex; align-items: center; gap: 10px; padding: 5px; border-radius: 6px; background: #f5f7fa; border: 1px solid #e4e7ed; flex-wrap: wrap; }
        .tab-item { display: flex; align-items: center; cursor: pointer; padding: 8px 16px; border-radius: 4px; transition: all 0.2s; }
        .tab-item input { display: none; }
        .tab-item label { margin: 0; cursor: pointer; font-weight: 500; }
        .tab-item:has(input:checked) { background: #409eff; color: #fff; }
        .tab-item:has(input:checked) label { color: #fff; }
        /* å‘½åè§„èŒƒå®¹å™¨éšè—/æ˜¾ç¤ºæ§åˆ¶ï¼ˆé»˜è®¤éšè—ï¼Œä»…å‰ç«¯æ˜¾ç¤ºï¼‰ */
        .name-rule { display: none; }
        .name-rule.show { display: block; }
        /* æ¨¡æ¿æ–‡ä»¶Tabæ ï¼šå³ä¾§é¢æ¿é¡¶éƒ¨ï¼Œç‹¬å ä¸€è¡Œ */
        #templateTabGroup { background: #e4e7ed; border-radius: 0; border: 0; border-bottom: 1px solid #dcdfe6; gap: 0; padding: 0; }
        #templateTabGroup .tab-item { border-radius: 0; padding: 10px 20px; }
        /* Monacoç¼–è¾‘å™¨å®¹å™¨ï¼šå æ»¡å³ä¾§é¢æ¿å‰©ä½™é«˜åº¦ */
        #monacoContainer { flex: 1; width: 100%; }
        /* ç¼–è¾‘å™¨åŠ è½½æç¤º */
        .editor-loading { display: flex; align-items: center; justify-content: center; height: 100%; color: #409EFF; font-size: 18px; }
        h2 { margin-bottom: 20px; color: #333; }
        p { margin: 10px 0; }
        /* å“åº”å¼å¸ƒå±€ï¼šå°å±å¹•ä¸‹æ”¹ä¸ºä¸Šä¸‹å¸ƒå±€ */
        @media (max-width: 1024px) {
            .layout-container {
                flex-direction: column;
                height: auto;
                min-height: 100vh;
            }
            .left-panel {
                flex: none;
                height: auto;
                max-height: 50vh;
                overflow-y: auto;
            }
            .right-panel {
                flex: 1;
                height: 50vh;
                min-height: 400px;
            }
        }
        /* è¶…å°å±å¹•è¿›ä¸€æ­¥ä¼˜åŒ– */
        @media (max-width: 768px) {
            .left-panel {
                max-height: 40vh;
                padding: 15px;
            }
            .right-panel {
                height: 60vh;
                min-height: 300px;
            }
            .module-input input {
                width: 100%;
                margin-left: 0;
                margin-top: 5px;
            }
            button {
                padding: 8px 12px;
                font-size: 14px;
                margin-right: 5px;
            }
        }
    </style>
    <!-- CDNå¼•å…¥Monaco Editorï¼ˆç¨³å®šç‰ˆæœ¬0.44.0ï¼‰ -->
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs/loader.js"></script>
</head>
<body>
    <!-- å·¦å³ä¸¤æ æ ¸å¿ƒå¸ƒå±€ -->
    <div class="layout-container">
        <!-- å·¦ä¾§ï¼šåŸæœ‰æ“ä½œç•Œé¢ -->
        <div class="left-panel">
            <h2>renren-fast å‰åç«¯CRUDä»£ç ç”Ÿæˆå™¨ï¼ˆå¤šTabæ¨¡æ¿ç¼–è¾‘ç‰ˆï¼‰</h2>
            <div class="module-input">
                <label>æ¨¡å—å(æ”¯æŒä»»æ„æ ¼å¼)ï¼š</label>
                <input type="text" id="moduleName" placeholder="å¦‚userInfo / UserInfo / user-info / å•†å“è®¢å•(ç©ºæ ¼)" autocomplete="off">
            </div>

            <!-- å‰åç«¯Tabåˆ‡æ¢ï¼šé»˜è®¤é€‰ä¸­å‰ç«¯Vueä»£ç  -->
            <div class="tab-container">
                <label>ç”Ÿæˆä»£ç ç±»å‹ï¼š</label>
                <div class="tab-group">
                    <div class="tab-item">
                        <input type="radio" name="codeType" id="frontend" value="frontend" checked>
                        <label for="frontend">å‰ç«¯Vueä»£ç </label>
                    </div>
                    <div class="tab-item">
                        <input type="radio" name="codeType" id="backend" value="backend">
                        <label for="backend">åç«¯Javaä»£ç </label>
                    </div>
                </div>
            </div>

            <!-- å‘½åè§„èŒƒå®¹å™¨ï¼šä»…å‰ç«¯æ˜¾ç¤ºï¼Œåç«¯å¼ºåˆ¶éšè— -->
            <div class="name-rule show" id="nameRuleContainer">
                <label>æ–‡ä»¶å‘½åè§„èŒƒï¼ˆä»…å‰ç«¯å¯ç”¨ï¼‰ï¼š</label>
                <input type="radio" name="nameRule" id="camelCase" value="camel" checked>
                <label for="camelCase">å¤§é©¼å³°ï¼ˆPascalCaseï¼‰</label>
                <input type="radio" name="nameRule" id="kebabCase" value="kebab">
                <label for="kebabCase">çŸ­æ¨ªçº¿ï¼ˆkebab-caseï¼‰</label>
            </div>

            <div class="dir-tree-container">
                <div class="dir-tree-title">ğŸ“ ç”Ÿæˆä»£ç ç›®å½•ç»“æ„é¢„è§ˆï¼ˆå®æ—¶æ›´æ–°ï¼‰</div>
                <div class="dir-tree" id="dirTreeArea">è¯·è¾“å…¥ä»»æ„æ ¼å¼æ¨¡å—åï¼Œè‡ªåŠ¨æ ‡å‡†åŒ–å¤„ç†å¹¶å±•ç¤ºç›®å½•ç»“æ„...</div>
            </div>
            
            <p>
                <button id="btnPick" disabled>ğŸ“‚ 1. é€‰æ‹©srcæ–‡ä»¶å¤¹ï¼ˆå‰ç«¯ï¼‰/ é¡¹ç›®æ ¹ç›®å½•ï¼ˆåç«¯ï¼‰</button>
                <button id="btnWrite" disabled>ğŸ’¾ 2. æ‰‹åŠ¨ç”ŸæˆCRUDä»£ç </button>
            </p>

            <div class="log" id="logArea">ç­‰å¾…æ“ä½œ...è¯·å…ˆè¾“å…¥æ¨¡å—å | å³ä¾§å¯ç¼–è¾‘åŸå§‹æ¨¡æ¿ï¼Œä¿®æ”¹åå…¨å±€ç”Ÿæ•ˆ</div>
        </div>

        <!-- å³ä¾§ï¼šæ¨¡æ¿Tabæ  + Monacoç¼–è¾‘å™¨é¢æ¿ï¼ˆé»˜è®¤éšè—ï¼Œç¼–è¾‘å™¨åŠ è½½æˆåŠŸåæ˜¾ç¤ºï¼‰ -->
        <div class="right-panel" id="rightPanel">
            <!-- æ¨¡æ¿æ–‡ä»¶Tabåˆ‡æ¢ï¼šå‰ç«¯/åç«¯è‡ªåŠ¨åˆ‡æ¢å¯¹åº”æ–‡ä»¶ -->
            <div class="tab-group" id="templateTabGroup">
                <!-- å‰ç«¯æ¨¡æ¿Tabï¼ˆé»˜è®¤æ˜¾ç¤ºï¼‰ -->
                <div class="tab-item template-tab frontend-tab">
                    <input type="radio" name="templateFile" id="tpl-api" value="api" checked>
                    <label for="tpl-api">APIæ¨¡æ¿ (api.js)</label>
                </div>
                <div class="tab-item template-tab frontend-tab">
                    <input type="radio" name="templateFile" id="tpl-router" value="router">
                    <label for="tpl-router">è·¯ç”±æ¨¡æ¿ (router.js)</label>
                </div>
                <div class="tab-item template-tab frontend-tab">
                    <input type="radio" name="templateFile" id="tpl-index" value="index">
                    <label for="tpl-index">åˆ—è¡¨æ¨¡æ¿ (index.vue)</label>
                </div>
                <div class="tab-item template-tab frontend-tab">
                    <input type="radio" name="templateFile" id="tpl-modal" value="modal">
                    <label for="tpl-modal">å¼¹çª—æ¨¡æ¿ (modal.vue)</label>
                </div>
                <!-- åç«¯æ¨¡æ¿Tabï¼ˆé»˜è®¤éšè—ï¼‰ -->
                <div class="tab-item template-tab backend-tab" style="display: none;">
                    <input type="radio" name="templateFile" id="tpl-entity" value="entity" checked>
                    <label for="tpl-entity">å®ä½“æ¨¡æ¿ (entity.java)</label>
                </div>
                <div class="tab-item template-tab backend-tab" style="display: none;">
                    <input type="radio" name="templateFile" id="tpl-controller" value="controller">
                    <label for="tpl-controller">æ§åˆ¶å™¨æ¨¡æ¿ (controller.java)</label>
                </div>
                <div class="tab-item template-tab backend-tab" style="display: none;">
                    <input type="radio" name="templateFile" id="tpl-service" value="service">
                    <label for="tpl-service">æœåŠ¡æ¥å£æ¨¡æ¿ (service.java)</label>
                </div>
                <div class="tab-item template-tab backend-tab" style="display: none;">
                    <input type="radio" name="templateFile" id="tpl-serviceImpl" value="serviceImpl">
                    <label for="tpl-serviceImpl">æœåŠ¡å®ç°æ¨¡æ¿ (serviceImpl.java)</label>
                </div>
                <div class="tab-item template-tab backend-tab" style="display: none;">
                    <input type="radio" name="templateFile" id="tpl-mapper" value="mapper">
                    <label for="tpl-mapper">Mapperæ¨¡æ¿ (mapper.java)</label>
                </div>
                <div class="tab-item template-tab backend-tab" style="display: none;">
                    <input type="radio" name="templateFile" id="tpl-mapperXml" value="mapperXml">
                    <label for="tpl-mapperXml">MapperXMLæ¨¡æ¿ (mapper.xml)</label>
                </div>
            </div>
            <!-- ç¼–è¾‘å™¨åŠ è½½æç¤º -->
            <div class="editor-loading" id="editorLoading">ğŸ“ æ­£åœ¨åŠ è½½ä»£ç ç¼–è¾‘å™¨...ï¼ˆç¦»çº¿ç¯å¢ƒå°†è‡ªåŠ¨éšè—ï¼‰</div>
            <!-- Monacoç¼–è¾‘å™¨å®¹å™¨ -->
            <div id="monacoContainer" style="display: none;"></div>
        </div>
    </div>

    <script>
        let targetDirHandle = null; // ç›®æ ‡ç›®å½•å¥æŸ„ï¼ˆå‰ç«¯=srcï¼Œåç«¯=é¡¹ç›®æ ¹ç›®å½•ï¼‰
        const logArea = document.getElementById('logArea');
        const dirTreeArea = document.getElementById('dirTreeArea');
        const btnPick = document.getElementById('btnPick');
        const btnWrite = document.getElementById('btnWrite');
        const moduleNameInput = document.getElementById('moduleName');
        const codeTypeRadios = document.getElementsByName('codeType');
        const nameRuleRadios = document.getElementsByName('nameRule');
        const nameRuleContainer = document.getElementById('nameRuleContainer');
        const rightPanel = document.getElementById('rightPanel');
        const editorLoading = document.getElementById('editorLoading');
        const monacoContainer = document.getElementById('monacoContainer');
        const templateFileRadios = document.getElementsByName('templateFile');
        const frontendTabs = document.querySelectorAll('.frontend-tab');
        const backendTabs = document.querySelectorAll('.backend-tab');
        // Monacoç¼–è¾‘å™¨å®ä¾‹
        let monacoEditor = null;
        // æ ¸å¿ƒï¼šåŸå§‹æ¨¡æ¿å­˜å‚¨å¯¹è±¡ï¼ˆæ‰€æœ‰ç¼–è¾‘æ“ä½œåŸºäºæ­¤ï¼Œä¿®æ”¹åå…¨å±€ç”Ÿæ•ˆï¼‰
        const TEMPLATES = {
            // å‰ç«¯åŸå§‹æ¨¡æ¿ï¼ˆæ— æ¨¡å—åï¼Œçº¯å¯å¤ç”¨æ¨¡æ¿ï¼‰
            frontend: {
                api: `import request from '@/utils/request'

// ã€æ¨¡å—åã€‘CRUDæ¥å£æ¨¡æ¿
export default {
  list(query) {
    return request({
      url: '/ã€æ¨¡å—æ ‡è¯†ã€‘/list',
      method: 'get',
      params: query
    })
  },
  info(id) {
    return request({
      url: '/ã€æ¨¡å—æ ‡è¯†ã€‘/info/' + id,
      method: 'get'
    })
  },
  save(data) {
    return request({
      url: '/ã€æ¨¡å—æ ‡è¯†ã€‘/save',
      method: 'post',
      data: data
    })
  },
  update(data) {
    return request({
      url: '/ã€æ¨¡å—æ ‡è¯†ã€‘/update',
      method: 'put',
      data: data
    })
  },
  delete(ids) {
    return request({
      url: '/ã€æ¨¡å—æ ‡è¯†ã€‘/delete',
      method: 'delete',
      data: ids
    })
  }
}`,
                router: `import Layout from '@/layout'

// ã€æ¨¡å—åã€‘è·¯ç”±æ¨¡æ¿
const ã€å¤§é©¼å³°æ¨¡å—åã€‘Router = {
  path: '/ã€æ¨¡å—æ ‡è¯†ã€‘',
  component: Layout,
  redirect: '/ã€æ¨¡å—æ ‡è¯†ã€‘/index',
  name: 'ã€å¤§é©¼å³°æ¨¡å—åã€‘',
  meta: { title: 'ã€æ¨¡å—åã€‘ç®¡ç†', icon: 'user' },
  children: [
    {
      path: 'index',
      component: () => import('@/views/ã€é¦–å•è¯æ¨¡å—åã€‘/index'),
      name: 'ã€å¤§é©¼å³°æ¨¡å—åã€‘Index',
      meta: { title: 'ã€æ¨¡å—åã€‘åˆ—è¡¨', noCache: true }
    }
  ]
}

export default ã€å¤§é©¼å³°æ¨¡å—åã€‘Router`,
                index: `<template>
  <div class="app-container">
    <el-form :inline="true" :model="queryParams" class="search-form" @keyup.enter.native="handleQuery">
      <el-form-item label="ã€æ¨¡å—åã€‘åç§°">
        <el-input v-model="queryParams.name" placeholder="è¯·è¾“å…¥åç§°" clearable @clear="handleQuery"/>
      </el-form-item>
      <el-form-item>
        <el-button type="primary" icon="el-icon-search" @click="handleQuery">æœç´¢</el-button>
        <el-button icon="el-icon-refresh" @click="resetQuery">é‡ç½®</el-button>
        <el-button type="success" icon="el-icon-plus" @click="handleAdd">æ–°å¢</el-button>
      </el-form-item>
    </el-form>

    <el-table v-loading="loading" :data="list" border @selection-change="handleSelectionChange">
      <el-table-column type="selection" width="55" align="center"/>
      <el-table-column label="ID" prop="id" width="80" align="center"/>
      <el-table-column label="ã€æ¨¡å—åã€‘åç§°" prop="name" align="center"/>
      <el-table-column label="åˆ›å»ºæ—¶é—´" prop="createTime" width="180" align="center"/>
      <el-table-column label="æ“ä½œ" width="160" align="center">
        <template slot-scope="scope">
          <el-button type="text" icon="el-icon-edit" @click="handleUpdate(scope.row)">ç¼–è¾‘</el-button>
          <el-button type="text" icon="el-icon-delete" @click="handleDelete(scope.row.id)">åˆ é™¤</el-button>
        </template>
      </el-table-column>
    </el-table>

    <el-pagination
      @size-change="handleSizeChange"
      @current-change="handleCurrentChange"
      :current-page="queryParams.pageNum"
      :page-sizes="[10,20,30,50]"
      :page-size="queryParams.pageSize"
      layout="total, sizes, prev, pager, next, jumper"
      :total="total"
      style="margin-top: 20px; text-align:right;">
    </el-pagination>

    <el-dialog :title="dialogTitle" :visible.sync="open" width="500px" append-to-body>
      <Modal ref="modal" :form="form" :isAdd="isAdd" @success="getList"/>
    </el-dialog>
  </div>
</template>

<script>
import Modal from './comp/modal'
import ã€å¤§é©¼å³°æ¨¡å—åã€‘Api from './api/api'

export default {
  name: 'ã€å¤§é©¼å³°æ¨¡å—åã€‘Index',
  components: { Modal },
  data() {
    return {
      loading: false,
      list: [],
      total: 0,
      open: false,
      isAdd: true,
      dialogTitle: '',
      form: {},
      queryParams: {
        pageNum: 1,
        pageSize: 10,
        name: null
      },
      ids: []
    }
  },
  created() {
    this.getList()
  },
  methods: {
    getList() {
      this.loading = true
      ã€å¤§é©¼å³°æ¨¡å—åã€‘Api.list(this.queryParams).then(res => {
        this.list = res.rows
        this.total = res.total
        this.loading = false
      }).catch(() => this.loading = false)
    },
    handleQuery() {
      this.queryParams.pageNum = 1
      this.getList()
    },
    resetQuery() {
      this.queryParams = { pageNum: 1, pageSize: 10, name: null }
      this.getList()
    },
    handleSizeChange(val) {
      this.queryParams.pageSize = val
      this.getList()
    },
    handleCurrentChange(val) {
      this.queryParams.pageNum = val
      this.getList()
    },
    handleSelectionChange(val) {
      this.ids = val.map(item => item.id)
    },
    handleAdd() {
      this.form = {}
      this.isAdd = true
      this.dialogTitle = "æ·»åŠ ã€æ¨¡å—åã€‘"
      this.open = true
    },
    handleUpdate(row) {
      this.form = { ...row }
      this.isAdd = false
      this.dialogTitle = "ä¿®æ”¹ã€æ¨¡å—åã€‘"
      this.open = true
    },
    handleDelete(id) {
      this.$modal.confirm('æ˜¯å¦ç¡®è®¤åˆ é™¤è¯¥æ•°æ®ï¼Ÿ').then(() => {
        return ã€å¤§é©¼å³°æ¨¡å—åã€‘Api.delete([id])
      }).then(() => {
        this.$modal.msgSuccess("åˆ é™¤æˆåŠŸ")
        this.getList()
      }).catch(() => {})
    }
  }
}
<\/script>

<style scoped>
.search-form {
  padding: 20px;
  background: #fbfbfb;
  margin-bottom: 20px;
  border: 1px solid #eee;
}
</style>`,
                modal: `<template>
  <el-form ref="form" :model="form" :rules="rules" label-width="100px">
    <el-form-item label="ã€æ¨¡å—åã€‘åç§°" prop="name">
      <el-input v-model="form.name" placeholder="è¯·è¾“å…¥ã€æ¨¡å—åã€‘åç§°"/>
    </el-form-item>
    <el-form-item label="å¤‡æ³¨" prop="remark">
      <el-input v-model="form.remark" type="textarea" rows="3" placeholder="è¯·è¾“å…¥å¤‡æ³¨"/>
    </el-form-item>
    <el-form-item align="center">
      <el-button type="primary" @click="submitForm">ç¡® å®š</el-button>
      <el-button @click="cancel">å– æ¶ˆ</el-button>
    </el-form-item>
  </el-form>
</template>

<script>
import ã€å¤§é©¼å³°æ¨¡å—åã€‘Api from '../api/api'

export default {
  name: "ã€å¤§é©¼å³°æ¨¡å—åã€‘Modal",
  props: {
    form: { type: Object, default: () => {} },
    isAdd: { type: Boolean, default: true }
  },
  data() {
    return {
      rules: {
        name: [{ required: true, message: "ã€æ¨¡å—åã€‘åç§°ä¸èƒ½ä¸ºç©º", trigger: "blur" }]
      }
    }
  },
  methods: {
    submitForm() {
      this.$refs.form.validate(valid => {
        if (valid) {
          const apiFunc = this.isAdd ? ã€å¤§é©¼å³°æ¨¡å—åã€‘Api.save : ã€å¤§é©¼å³°æ¨¡å—åã€‘Api.update
          apiFunc(this.form).then(() => {
            this.$modal.msgSuccess(this.isAdd ? "æ–°å¢æˆåŠŸ" : "ä¿®æ”¹æˆåŠŸ");
            this.$emit("success");
            this.closeDialog();
          })
        }
      })
    },
    cancel() {
      this.closeDialog()
    },
    closeDialog() {
      this.$refs.form.resetFields();
      this.$emit("update:visible", false);
    }
  }
}
<\/script>`
            },
            // åç«¯åŸå§‹æ¨¡æ¿ï¼ˆæ— æ¨¡å—åï¼Œçº¯å¯å¤ç”¨æ¨¡æ¿ï¼‰
            backend: {
                entity: `package com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.entity;

import com.baomidou.mybatisplus.annotation.IdType;
import com.baomidou.mybatisplus.annotation.TableId;
import com.baomidou.mybatisplus.annotation.TableName;
import lombok.Data;
import java.io.Serializable;
import java.util.Date;

/**
 * ã€æ¨¡å—åã€‘å®ä½“ç±»
 * çº¯å¯å¤ç”¨æ¨¡æ¿ï¼Œç”Ÿæˆæ—¶è‡ªåŠ¨æ›¿æ¢æ¨¡å—å
 */
@Data
@TableName("ã€å°å†™æ¨¡å—åã€‘")
public class ã€å¤§é©¼å³°æ¨¡å—åã€‘ implements Serializable {
    private static final long serialVersionUID = 1L;

    /**
     * ä¸»é”®ID
     */
    @TableId(type = IdType.AUTO)
    private Long id;

    /**
     * ã€æ¨¡å—åã€‘åç§°
     */
    private String name;

    /**
     * å¤‡æ³¨
     */
    private String remark;

    /**
     * åˆ›å»ºæ—¶é—´
     */
    private Date createTime;

    /**
     * æ›´æ–°æ—¶é—´
     */
    private Date updateTime;

    /**
     * åˆ é™¤æ ‡è®°ï¼ˆ0=æ­£å¸¸ï¼Œ1=åˆ é™¤ï¼‰
     */
    private Integer delFlag;
}`,
                controller: `package com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.controller;

import com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.entity.ã€å¤§é©¼å³°æ¨¡å—åã€‘;
import com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.service.ã€å¤§é©¼å³°æ¨¡å—åã€‘Service;
import com.renren.common.utils.R;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;
import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
import java.util.List;

/**
 * ã€æ¨¡å—åã€‘æ§åˆ¶å™¨
 * çº¯å¯å¤ç”¨æ¨¡æ¿ï¼Œç”Ÿæˆæ—¶è‡ªåŠ¨æ›¿æ¢æ¨¡å—å
 */
@RestController
@RequestMapping("/ã€å°å†™æ¨¡å—åã€‘")
public class ã€å¤§é©¼å³°æ¨¡å—åã€‘Controller {

    @Autowired
    private ã€å¤§é©¼å³°æ¨¡å—åã€‘Service ã€å°å†™æ¨¡å—åã€‘Service;

    /**
     * åˆ†é¡µæŸ¥è¯¢ã€æ¨¡å—åã€‘åˆ—è¡¨
     */
    @GetMapping("/list")
    public R list(@RequestParam(defaultValue = "1") Integer pageNum,
                  @RequestParam(defaultValue = "10") Integer pageSize,
                  ã€å¤§é©¼å³°æ¨¡å—åã€‘ ã€å°å†™æ¨¡å—åã€‘) {
        Page<ã€å¤§é©¼å³°æ¨¡å—åã€‘> page = new Page<>(pageNum, pageSize);
        Page<ã€å¤§é©¼å³°æ¨¡å—åã€‘> result = ã€å°å†™æ¨¡å—åã€‘Service.page(page, null);
        return R.ok().put("page", result);
    }

    /**
     * æ ¹æ®IDæŸ¥è¯¢ã€æ¨¡å—åã€‘è¯¦æƒ…
     */
    @GetMapping("/info/{id}")
    public R info(@PathVariable Long id) {
        ã€å¤§é©¼å³°æ¨¡å—åã€‘ ã€å°å†™æ¨¡å—åã€‘ = ã€å°å†™æ¨¡å—åã€‘Service.getById(id);
        return R.ok().put("ã€å°å†™æ¨¡å—åã€‘", ã€å°å†™æ¨¡å—åã€‘);
    }

    /**
     * æ–°å¢ã€æ¨¡å—åã€‘
     */
    @PostMapping("/save")
    public R save(@RequestBody ã€å¤§é©¼å³°æ¨¡å—åã€‘ ã€å°å†™æ¨¡å—åã€‘) {
        ã€å°å†™æ¨¡å—åã€‘Service.save(ã€å°å†™æ¨¡å—åã€‘);
        return R.ok();
    }

    /**
     * ä¿®æ”¹ã€æ¨¡å—åã€‘
     */
    @PutMapping("/update")
    public R update(@RequestBody ã€å¤§é©¼å³°æ¨¡å—åã€‘ ã€å°å†™æ¨¡å—åã€‘) {
        ã€å°å†™æ¨¡å—åã€‘Service.updateById(ã€å°å†™æ¨¡å—åã€‘);
        return R.ok();
    }

    /**
     * æ‰¹é‡åˆ é™¤ã€æ¨¡å—åã€‘
     */
    @DeleteMapping("/delete")
    public R delete(@RequestBody List<Long> ids) {
        ã€å°å†™æ¨¡å—åã€‘Service.removeByIds(ids);
        return R.ok();
    }
}`,
                service: `package com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.service;

import com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.entity.ã€å¤§é©¼å³°æ¨¡å—åã€‘;
import com.baomidou.mybatisplus.extension.service.IService;

/**
 * ã€æ¨¡å—åã€‘æœåŠ¡æ¥å£
 * çº¯å¯å¤ç”¨æ¨¡æ¿ï¼Œç”Ÿæˆæ—¶è‡ªåŠ¨æ›¿æ¢æ¨¡å—å
 */
public interface ã€å¤§é©¼å³°æ¨¡å—åã€‘Service extends IService<ã€å¤§é©¼å³°æ¨¡å—åã€‘> {
}`,
                serviceImpl: `package com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.service.impl;

import com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.entity.ã€å¤§é©¼å³°æ¨¡å—åã€‘;
import com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.mapper.ã€å¤§é©¼å³°æ¨¡å—åã€‘Mapper;
import com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.service.ã€å¤§é©¼å³°æ¨¡å—åã€‘Service;
import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
import org.springframework.stereotype.Service;

/**
 * ã€æ¨¡å—åã€‘æœåŠ¡å®ç°ç±»
 * çº¯å¯å¤ç”¨æ¨¡æ¿ï¼Œç”Ÿæˆæ—¶è‡ªåŠ¨æ›¿æ¢æ¨¡å—å
 */
@Service
public class ã€å¤§é©¼å³°æ¨¡å—åã€‘ServiceImpl extends ServiceImpl<ã€å¤§é©¼å³°æ¨¡å—åã€‘Mapper, ã€å¤§é©¼å³°æ¨¡å—åã€‘> implements ã€å¤§é©¼å³°æ¨¡å—åã€‘Service {
}`,
                mapper: `package com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.mapper;

import com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.entity.ã€å¤§é©¼å³°æ¨¡å—åã€‘;
import com.baomidou.mybatisplus.core.mapper.BaseMapper;

/**
 * ã€æ¨¡å—åã€‘Mapperæ¥å£
 * çº¯å¯å¤ç”¨æ¨¡æ¿ï¼Œç”Ÿæˆæ—¶è‡ªåŠ¨æ›¿æ¢æ¨¡å—å
 */
public interface ã€å¤§é©¼å³°æ¨¡å—åã€‘Mapper extends BaseMapper<ã€å¤§é©¼å³°æ¨¡å—åã€‘> {
}`,
                mapperXml: `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.mapper.ã€å¤§é©¼å³°æ¨¡å—åã€‘Mapper">

    <!-- é€šç”¨æŸ¥è¯¢æ˜ å°„ç»“æœ -->
    <resultMap id="BaseResultMap" type="com.renren.modular.ã€å¤§é©¼å³°æ¨¡å—åã€‘.entity.ã€å¤§é©¼å³°æ¨¡å—åã€‘">
        <id column="id" property="id" />
        <result column="name" property="name" />
        <result column="remark" property="remark" />
        <result column="create_time" property="createTime" />
        <result column="update_time" property="updateTime" />
        <result column="del_flag" property="delFlag" />
    </resultMap>

    <!-- é€šç”¨æŸ¥è¯¢ç»“æœåˆ— -->
    <sql id="Base_Column_List">
        id, name, remark, create_time, update_time, del_flag
    </sql>

</mapper>`
            }
        };
        // æœ¬åœ°å­˜å‚¨keyï¼ˆè¯­ä¹‰åŒ–ï¼‰
        const STORAGE_KEY = 'renrenFastCodeGenConfig';
        // å…¨å±€çŠ¶æ€ï¼ˆé»˜è®¤å‰ç«¯Vueä»£ç ï¼‰
        let moduleRaw = ''; 
        let moduleDir = '';    // æ¨¡å—æ ‡è¯†ï¼ˆkebab-case/å°å†™ï¼‰
        let moduleCamel = '';  // å¤§é©¼å³°æ¨¡å—å
        let moduleKebab = '';  // çŸ­æ¨ªçº¿æ¨¡å—å
        let moduleLower = '';  // å°å†™æ¨¡å—å
        let viewFolder = '';   // å‰ç«¯è§†å›¾æ–‡ä»¶å¤¹ï¼ˆé¦–å•è¯ï¼‰
        let currentCodeType = 'frontend'; // é»˜è®¤é€‰ä¸­å‰ç«¯Vue
        let currentNameRule = 'camel';
        let currentTemplateFile = 'api'; // é»˜è®¤ç¼–è¾‘APIæ¨¡æ¿

        // ========== æ ¸å¿ƒï¼šMonaco Editoråˆå§‹åŒ–ï¼ˆä¿®å¤blobè¯­æ³•é”™è¯¯+CDN+ç¦»çº¿å…¼å®¹ï¼‰ ==========
        function initMonacoEditor() {
            // é…ç½®MonacoåŠ è½½è·¯å¾„ï¼ˆCDNï¼‰
            require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs' } });
            // âœ… ä¿®å¤æ ¸å¿ƒï¼šç»™blob://æ·»åŠ å•å¼•å·ï¼Œè¿”å›åˆæ³•å­—ç¬¦ä¸²ï¼Œè§£å†³è¯­æ³•é”™è¯¯
            window.MonacoEnvironment = { getWorkerUrl: () => 'blob://' };

            require(['vs/editor/editor.main'], () => {
                // ç¼–è¾‘å™¨åŠ è½½æˆåŠŸï¼šæ˜¾ç¤ºå³ä¾§é¢æ¿+ç¼–è¾‘å™¨ï¼Œéšè—åŠ è½½æç¤º
                rightPanel.style.display = 'flex';
                editorLoading.style.display = 'none';
                monacoContainer.style.display = 'block';
                // åˆå§‹åŒ–ç¼–è¾‘å™¨
                monacoEditor = monaco.editor.create(monacoContainer, {
                    value: TEMPLATES.frontend[currentTemplateFile],
                    language: getTemplateLanguage(currentTemplateFile, currentCodeType),
                    theme: 'vs-light',
                    fontSize: 14,
                    lineNumbers: 'on',
                    minimap: { enabled: false },
                    wordWrap: 'on',
                    tabSize: 2,
                    // ç¦ç”¨è¯­æ³•æ ¡éªŒå’Œçº¢è‰²ä¸‹åˆ’çº¿
                    diagnostics: 'off',
                    renderValidationDecorations: 'off',
                    hideMarkersInOverviewRuler: true
                });
                // ç¼–è¾‘å™¨è‡ªé€‚åº”çª—å£å¤§å°
                window.addEventListener('resize', () => monacoEditor?.layout());
                // ç›‘å¬ç¼–è¾‘å™¨å†…å®¹å˜åŒ–ï¼Œå®æ—¶æ›´æ–°åŸå§‹æ¨¡æ¿
                monacoEditor.onDidChangeModelContent(() => {
                    TEMPLATES[currentCodeType][currentTemplateFile] = monacoEditor.getValue();
                });
                log('âœ… ä»£ç ç¼–è¾‘å™¨åŠ è½½æˆåŠŸï¼Œå¯ç¼–è¾‘åŸå§‹æ¨¡æ¿ï¼ˆä¿®æ”¹åå…¨å±€ç”Ÿæ•ˆï¼‰', false);
            }, (err) => {
                // åŠ è½½å¤±è´¥ï¼ˆç¦»çº¿/CDNä¸å¯ç”¨ï¼‰ï¼šéšè—æ•´ä¸ªå³ä¾§é¢æ¿ï¼Œæ— æŠ¥é”™æç¤º
                rightPanel.style.display = 'none';
                console.log('â„¹ï¸ ç¦»çº¿ç¯å¢ƒï¼Œä»£ç ç¼–è¾‘å™¨å·²è‡ªåŠ¨éšè—', err);
            });
        }
        // é¡µé¢åŠ è½½åç«‹å³åˆå§‹åŒ–Monaco
        window.addEventListener('DOMContentLoaded', initMonacoEditor);

        // ========== æ ¸å¿ƒï¼šæ ¹æ®æ¨¡æ¿ç±»å‹å’Œä»£ç ç±»å‹è·å–è¯­æ³•é«˜äº®è¯­è¨€ ==========
        function getTemplateLanguage(tplFile, codeType) {
            if (codeType === 'backend') {
                return tplFile === 'mapperXml' ? 'xml' : 'java';
            }
            return tplFile.includes('vue') ? 'vue' : 'javascript';
        }

        // ========== æ ¸å¿ƒï¼šåˆ‡æ¢æ¨¡æ¿Tabï¼ˆæ›´æ–°ç¼–è¾‘å™¨å†…å®¹å’Œè¯­æ³•ï¼‰ ==========
        function switchTemplateTab(tplFile) {
            currentTemplateFile = tplFile;
            if (!monacoEditor) return;
            // æ›´æ–°ç¼–è¾‘å™¨å†…å®¹ï¼ˆåŸå§‹æ¨¡æ¿ï¼‰å’Œè¯­æ³•é«˜äº®
            monacoEditor.setValue(TEMPLATES[currentCodeType][tplFile]);
            monacoEditor.setModelLanguage(
                monacoEditor.getModel(),
                getTemplateLanguage(tplFile, currentCodeType)
            );
            // ç¼–è¾‘å™¨è‡ªé€‚åº”
            monacoEditor.layout();
            log(`âœ… åˆ‡æ¢è‡³ã€${getTemplateFileName(tplFile, currentCodeType)}ã€‘åŸå§‹æ¨¡æ¿ç¼–è¾‘`, false);
        }

        // ========== æ ¸å¿ƒï¼šè·å–æ¨¡æ¿å¯¹åº”çš„æ–‡ä»¶åï¼ˆç”¨äºæç¤ºï¼‰ ==========
        function getTemplateFileName(tplFile, codeType) {
            const nameMap = {
                frontend: { api: 'api.js', router: 'router.js', index: 'index.vue', modal: 'modal.vue' },
                backend: { entity: 'entity.java', controller: 'controller.java', service: 'service.java', serviceImpl: 'serviceImpl.java', mapper: 'mapper.java', mapperXml: 'mapper.xml' }
            };
            return nameMap[codeType][tplFile];
        }

        // ========== æ ¸å¿ƒï¼šåˆ‡æ¢å‰åç«¯ä»£ç ç±»å‹ï¼ˆåŒæ­¥æ¨¡æ¿Tabå’Œç¼–è¾‘å™¨ï¼‰ ==========
        function switchCodeType(codeType) {
            currentCodeType = codeType;
            // åˆ‡æ¢æ¨¡æ¿Tabæ˜¾ç¤º/éšè—
            frontendTabs.forEach(tab => tab.style.display = codeType === 'frontend' ? 'flex' : 'none');
            backendTabs.forEach(tab => tab.style.display = codeType === 'backend' ? 'flex' : 'none');
            // è·å–å½“å‰ä»£ç ç±»å‹çš„é»˜è®¤æ¨¡æ¿
            const defaultTpl = codeType === 'frontend' ? 'api' : 'entity';
            // é€‰ä¸­é»˜è®¤æ¨¡æ¿Radio
            document.querySelector(`input[name="templateFile"][value="${defaultTpl}"]`).checked = true;
            // åˆ‡æ¢ç¼–è¾‘å™¨æ¨¡æ¿
            switchTemplateTab(defaultTpl);
            // âœ… ä¿®å¤1ï¼šå¼ºåˆ¶æ§åˆ¶å‘½åè§„åˆ™é¢æ¿æ˜¾ç¤º/éšè—ï¼ˆå‰ç«¯æ˜¾ç¤ºã€åç«¯éšè—ï¼‰
            toggleNameRuleContainer();
            // æ›´æ–°æŒ‰é’®æ–‡å­—
            updateBtnPickText();
            // é‡æ–°æ ‡å‡†åŒ–æ¨¡å—åï¼ˆè‹¥æœ‰è¾“å…¥ï¼‰
            if (moduleRaw) {
                const standardRes = standardizeModuleName(moduleRaw);
                if (standardRes.valid) updateModuleState(standardRes);
            }
            // æ›´æ–°ç›®å½•æ ‘
            updateDirTree();
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šæœ¬åœ°å­˜å‚¨åˆå§‹åŒ– ==========
        function initFromLocalStorage() {
            const savedConfig = localStorage.getItem(STORAGE_KEY);
            if (savedConfig) {
                try {
                    const { moduleName, codeType, nameRule } = JSON.parse(savedConfig);

                    // 1. ä¼˜å…ˆæ¢å¤æ‰€æœ‰çŠ¶æ€å˜é‡
                    if (codeType && ['frontend', 'backend'].includes(codeType)) {
                        currentCodeType = codeType;
                        Array.from(codeTypeRadios).forEach(radio => radio.checked = radio.value === codeType);
                    }

                    // âœ… ä¿®å¤2ï¼šæœ¬åœ°å­˜å‚¨æ¢å¤å‘½åè§„åˆ™æ—¶ï¼Œå¼ºåˆ¶åŒæ­¥Radioé€‰ä¸­çŠ¶æ€
                    if (nameRule && ['camel', 'kebab'].includes(nameRule)) {
                        currentNameRule = nameRule;
                        Array.from(nameRuleRadios).forEach(radio => {
                            radio.checked = radio.value === nameRule;
                        });
                    }

                    if (moduleName) {
                        moduleNameInput.value = moduleName;
                        moduleRaw = moduleName;
                        // é¢„å…ˆæ£€æŸ¥æœ‰æ•ˆæ€§ä»¥å¯ç”¨æŒ‰é’®
                        if (standardizeModuleName(moduleName).valid) {
                            btnPick.disabled = false;
                        }
                    }

                    // 2. ç»Ÿä¸€è§¦å‘çŠ¶æ€æ›´æ–°ï¼ˆä¼šä½¿ç”¨ä¸Šé¢æ¢å¤çš„ currentCodeType å’Œ currentNameRuleï¼‰
                    switchCodeType(currentCodeType);

                    log(`âœ… æœ¬åœ°é…ç½®å·²å›æ˜¾ï¼šæ¨¡å—åã€${moduleName || 'æ— '}ã€‘| ä»£ç ç±»å‹ã€${currentCodeType === 'frontend' ? 'å‰ç«¯Vue' : 'åç«¯Java'}ã€‘${currentCodeType === 'frontend' ? '| å‘½åè§„èŒƒã€' + (currentNameRule === 'camel' ? 'å¤§é©¼å³°' : 'çŸ­æ¨ªçº¿') + 'ã€‘' : ''}`, false);
                } catch (e) {
                    localStorage.removeItem(STORAGE_KEY);
                    log('âš ï¸ æœ¬åœ°é…ç½®æŸåï¼Œå·²è‡ªåŠ¨æ¸…é™¤', false);
                }
            }
            updateBtnWriteState();
        }
        // ========== æ ¸å¿ƒï¼šæ¨¡æ¿æ¸²æŸ“ï¼ˆå°†åŸå§‹æ¨¡æ¿æ›¿æ¢ä¸ºå®é™…æ¨¡å—åç”Ÿæˆä»£ç ï¼‰ ==========
        function renderTemplate(tplContent) {
            if (!moduleRaw || !moduleCamel) return tplContent;
            // æ¨¡æ¿æ›¿æ¢æ˜ å°„è¡¨
            const replaceMap = {
                'ã€æ¨¡å—åã€‘': moduleRaw,
                'ã€æ¨¡å—æ ‡è¯†ã€‘': moduleDir,
                'ã€å¤§é©¼å³°æ¨¡å—åã€‘': moduleCamel,
                'ã€çŸ­æ¨ªçº¿æ¨¡å—åã€‘': moduleKebab,
                'ã€å°å†™æ¨¡å—åã€‘': moduleLower,
                'ã€é¦–å•è¯æ¨¡å—åã€‘': viewFolder
            };
            // æ‰¹é‡æ›¿æ¢æ¨¡æ¿å ä½ç¬¦
            return Object.keys(replaceMap).reduce((content, key) => {
                return content.replace(new RegExp(key, 'g'), replaceMap[key]);
            }, tplContent);
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šä¿å­˜é…ç½®åˆ°æœ¬åœ°å­˜å‚¨ ==========
        function saveToLocalStorage() {
            const config = {
                moduleName: moduleRaw,
                codeType: currentCodeType,
                nameRule: currentNameRule
            };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(config));
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šæ—¥å¿—å‡½æ•° ==========
        function log(msg, isError = false) {
            logArea.innerText = msg;
            logArea.style.color = isError ? 'red' : '#27ae60';
            console.log(msg);
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šæ›´æ–°æ¨¡å—çŠ¶æ€ï¼ˆæ–°å¢å°å†™æ¨¡å—åï¼‰ ==========
        function updateModuleState(standardRes) {
            moduleDir = currentCodeType === 'backend' ? standardRes.camel.toLowerCase() : (currentNameRule === 'camel' ? standardRes.camel : standardRes.kebab);
            moduleCamel = standardRes.camel;
            moduleKebab = standardRes.kebab;
            moduleLower = standardRes.camel.toLowerCase(); // æ–°å¢ï¼šå°å†™æ¨¡å—å
            viewFolder = standardRes.viewFolder;
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šè·å–å½“å‰é€‰æ‹© ==========
        function getCurrentCodeType() {
            for (let radio of codeTypeRadios) {
                if (radio.checked) return radio.value;
            }
            return 'frontend';
        }

        function getCurrentNameRule() {
            for (let radio of nameRuleRadios) {
                if (radio.checked) return radio.value;
            }
            return 'camel';
        }

        // ========== âœ… ä¿®å¤3ï¼šé‡æ„å‘½åè§„åˆ™é¢æ¿æ§åˆ¶ï¼ˆå¼ºåˆ¶å‰ç«¯æ˜¾ç¤ºã€åç«¯éšè—ï¼‰ ==========
        function toggleNameRuleContainer() {
            if (currentCodeType === 'frontend') {
                nameRuleContainer.classList.add('show');
            } else {
                nameRuleContainer.classList.remove('show');
                currentNameRule = 'camel';
            }
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šæ›´æ–°æŒ‰é’®æ–‡å­— ==========
        function updateBtnPickText() {
            btnPick.innerText = currentCodeType === 'frontend'
                ? 'ğŸ“‚ 1. é€‰æ‹©srcæ–‡ä»¶å¤¹ï¼ˆå‰ç«¯Vueä»£ç ï¼‰'
                : 'ğŸ“‚ 1. é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•ï¼ˆåç«¯Javaä»£ç ï¼‰';
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šå‘½åæ ¼å¼è½¬æ¢ ==========
        function camelToKebab(str) {
            return str.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();
        }

        function toPascalCase(str) {
            str = str.replace(/[^a-zA-Z0-9]/g, ' ');
            return str.split(' ').filter(word => word).map(word => 
                word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
            ).join('');
        }

        function getFirstWord(standardKebab) {
            return standardKebab.split('-')[0].toLowerCase();
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šè·å–æ–‡ä»¶å ==========
        function getFileName(type) {
            const frontendSuffix = {
                camel: { api: 'Api.js', router: 'Router.js', index: 'Index.vue', modal: 'Modal.vue' },
                kebab: { api: '-api.js', router: '-router.js', index: '-index.vue', modal: '-modal.vue' }
            };
            const backendSuffix = {
                camel: { 
                    entity: '.java', controller: 'Controller.java', 
                    service: 'Service.java', serviceImpl: 'ServiceImpl.java',
                    mapper: 'Mapper.java', mapperXml: 'Mapper.xml'
                }
            };
            const prefix = currentCodeType === 'backend' ? moduleCamel : (currentNameRule === 'camel' ? moduleCamel : moduleKebab);
            const suffixMap = currentCodeType === 'backend' ? backendSuffix.camel : frontendSuffix[currentNameRule];
            return prefix + suffixMap[type];
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šæ¨¡å—åæ ‡å‡†åŒ–ï¼ˆæ–°å¢å°å†™æ¨¡å—åå¤„ç†ï¼‰ ==========
        function standardizeModuleName(rawName) {
            if (!rawName.trim()) return { valid: false };
            const camel = toPascalCase(rawName);
            if (!camel) return { valid: false };
            const kebab = camelToKebab(camel);
            const viewFolder = getFirstWord(kebab);
            return {
                valid: true,
                dir: currentCodeType === 'backend' ? camel.toLowerCase() : (currentNameRule === 'camel' ? camel : kebab),
                camel: camel,
                kebab: kebab,
                viewFolder: viewFolder
            };
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šç”Ÿæˆç›®å½•æ ‘ ==========
        function generateDirTree() {
            if (!moduleRaw) return 'è¯·è¾“å…¥ä»»æ„æ ¼å¼æ¨¡å—åï¼Œè‡ªåŠ¨æ ‡å‡†åŒ–å¤„ç†å¹¶å±•ç¤ºç›®å½•ç»“æ„...\\n\\nå³ä¾§å¯ç¼–è¾‘åŸå§‹æ¨¡æ¿ï¼Œæ‰€æœ‰ç”Ÿæˆæ“ä½œå‡åŸºäºä¿®æ”¹åçš„æ¨¡æ¿æ‰§è¡Œï¼';
            if (!moduleDir) return 'æ¨¡å—åæ— æ•ˆï¼è¯·è¾“å…¥å­—æ¯/æ•°å­—/ç©ºæ ¼/é©¼å³°æ ¼å¼ï¼Œé¿å…ä»…è¾“å…¥ç‰¹æ®Šå­—ç¬¦';

            if (currentCodeType === 'frontend') {
                const apiFile = getFileName('api');
                const routerFile = getFileName('router');
                const indexFile = getFileName('index');
                const modalFile = getFileName('modal');
                return `src/
â”œâ”€â”€ router/
â”‚   â””â”€â”€ modules/
â”‚       â””â”€â”€ ${routerFile}  # è·¯ç”±æ–‡ä»¶
â””â”€â”€ views/
    â””â”€â”€ ${viewFolder}/     # è§†å›¾æ–‡ä»¶å¤¹
        â”œâ”€â”€ api/           # APIæ–‡ä»¶å¤¹
        â”‚   â””â”€â”€ ${apiFile}
        â”œâ”€â”€ comp/          # ç»„ä»¶æ–‡ä»¶å¤¹
        â”‚   â””â”€â”€ ${modalFile} # å¼¹çª—ç»„ä»¶
        â””â”€â”€ ${indexFile}    # åˆ—è¡¨é¡µé¢

> åŸå§‹è¾“å…¥ï¼š${moduleRaw}
> æ ‡å‡†åŒ–å¤„ç†ï¼šã€${moduleDir}ã€‘â†’ å¤§é©¼å³°ã€${moduleCamel}ã€‘â†’ çŸ­æ¨ªçº¿ã€${moduleKebab}ã€‘
> ä»£ç ç±»å‹ï¼šå‰ç«¯Vue | å‘½åè§„èŒƒï¼š${currentNameRule === 'camel' ? 'å¤§é©¼å³°ï¼ˆPascalCaseï¼‰' : 'çŸ­æ¨ªçº¿ï¼ˆkebab-caseï¼‰'}
> æ¨¡æ¿çŠ¶æ€ï¼šå·²åŠ è½½4ä¸ªå‰ç«¯åŸå§‹æ¨¡æ¿ï¼Œæ”¯æŒç‹¬ç«‹ç¼–è¾‘
> ç”Ÿæˆè§„åˆ™ï¼šæ‰€æœ‰æ–‡ä»¶å‡ç”±å³ä¾§ç¼–è¾‘çš„åŸå§‹æ¨¡æ¿æ¸²æŸ“ç”Ÿæˆ`;
            }

            if (currentCodeType === 'backend') {
                const entityFile = getFileName('entity');
                const controllerFile = getFileName('controller');
                const serviceFile = getFileName('service');
                const serviceImplFile = getFileName('serviceImpl');
                const mapperFile = getFileName('mapper');
                const xmlFile = getFileName('mapperXml');
                return `é¡¹ç›®æ ¹ç›®å½•/
â””â”€â”€ main/
    â”œâ”€â”€ java/
    â”‚   â””â”€â”€ com/
    â”‚       â””â”€â”€ renren/
    â”‚           â””â”€â”€ modular/
    â”‚               â””â”€â”€ ${moduleLower}/  # æ¨¡å—åŒ…
    â”‚                   â”œâ”€â”€ entity/
    â”‚                   â”‚   â””â”€â”€ ${entityFile}  # å®ä½“ç±»
    â”‚                   â”œâ”€â”€ controller/
    â”‚                   â”‚   â””â”€â”€ ${controllerFile}  # æ§åˆ¶å™¨
    â”‚                   â”œâ”€â”€ service/
    â”‚                   â”‚   â”œâ”€â”€ ${serviceFile}     # æœåŠ¡æ¥å£
    â”‚                   â”‚   â””â”€â”€ impl/
    â”‚                   â”‚       â””â”€â”€ ${serviceImplFile}  # æœåŠ¡å®ç°
    â”‚                   â””â”€â”€ mapper/
    â”‚                       â””â”€â”€ ${mapperFile}  # Mapperæ¥å£
    â””â”€â”€ resources/
        â””â”€â”€ mapper/
            â””â”€â”€ ${moduleLower}/  # MapperXMLæ–‡ä»¶å¤¹
                â””â”€â”€ ${xmlFile}  # MapperXMLæ–‡ä»¶

> åŸå§‹è¾“å…¥ï¼š${moduleRaw}
> æ ‡å‡†åŒ–å¤„ç†ï¼šçº¯å¤§é©¼å³°ã€${moduleCamel}ã€‘â†’ å°å†™ã€${moduleLower}ã€‘
> ä»£ç ç±»å‹ï¼šåç«¯Java | å¼ºåˆ¶å¤§é©¼å³°å‘½å
> æ¨¡æ¿çŠ¶æ€ï¼šå·²åŠ è½½6ä¸ªåç«¯åŸå§‹æ¨¡æ¿ï¼Œæ”¯æŒç‹¬ç«‹ç¼–è¾‘
> ç”Ÿæˆè§„åˆ™ï¼šæ‰€æœ‰æ–‡ä»¶å‡ç”±å³ä¾§ç¼–è¾‘çš„åŸå§‹æ¨¡æ¿æ¸²æŸ“ç”Ÿæˆ
> è·¯å¾„è¯´æ˜ï¼šæ— srcé‡å¤ï¼Œå®Œå…¨åŒ¹é…çœŸå®é¡¹ç›®ç»“æ„`;
            }
        }

        function updateDirTree() {
            dirTreeArea.innerText = generateDirTree();
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šæ›´æ–°æŒ‰é’®çŠ¶æ€ ==========
        function updateBtnWriteState() {
            btnWrite.disabled = !targetDirHandle || !moduleDir;
        }

        // ========== äº‹ä»¶ç›‘å¬ï¼šæ¨¡å—åè¾“å…¥ ==========
        moduleNameInput.addEventListener('input', () => {
            const rawName = moduleNameInput.value;
            moduleRaw = rawName;
            const standardRes = standardizeModuleName(rawName);
            if (standardRes.valid) {
                updateModuleState(standardRes);
                updateDirTree();
                btnPick.disabled = false;
                updateBtnWriteState();
                log(`${currentCodeType === 'backend' ? 'åç«¯æ¨¡å—åæ ‡å‡†åŒ–æˆåŠŸ' : 'å‰ç«¯æ¨¡å—åæ ‡å‡†åŒ–æˆåŠŸ'}ï¼šã€${rawName}ã€‘â†’ ã€${moduleDir}ã€‘ï¼Œå¯ç”Ÿæˆä»£ç `, false);
            } else {
                btnPick.disabled = true;
                btnWrite.disabled = true;
                moduleDir = '';
                moduleCamel = '';
                moduleKebab = '';
                moduleLower = '';
                viewFolder = '';
                if (rawName) {
                    log('æ¨¡å—åæ— æ•ˆï¼è¯·è¾“å…¥å­—æ¯/æ•°å­—/ç©ºæ ¼/é©¼å³°æ ¼å¼ï¼Œé¿å…ä»…è¾“å…¥ç‰¹æ®Šå­—ç¬¦', true);
                    dirTreeArea.innerText = 'æ¨¡å—åå¤„ç†åä¸ºç©ºï¼è¯·è¾“å…¥æœ‰æ•ˆæ ¼å¼çš„æ¨¡å—åï¼ˆå­—æ¯/æ•°å­—/ç©ºæ ¼/é©¼å³°ï¼‰';
                } else {
                    log('ç­‰å¾…æ“ä½œ...è¯·å…ˆè¾“å…¥æ¨¡å—å | å³ä¾§å¯ç¼–è¾‘åŸå§‹æ¨¡æ¿ï¼Œä¿®æ”¹åå…¨å±€ç”Ÿæ•ˆ', false);
                    dirTreeArea.innerText = generateDirTree();
                }
            }
        });

        // ========== äº‹ä»¶ç›‘å¬ï¼šå‰åç«¯ä»£ç ç±»å‹åˆ‡æ¢ ==========
        codeTypeRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                switchCodeType(radio.value);
                log(`å·²åˆ‡æ¢ä»£ç ç±»å‹ï¼š${currentCodeType === 'frontend' ? 'å‰ç«¯Vueä»£ç ï¼ˆ4ä¸ªæ¨¡æ¿ï¼‰' : 'åç«¯Javaä»£ç ï¼ˆ6ä¸ªæ¨¡æ¿ï¼‰'}`, false);
                updateBtnWriteState();
                saveToLocalStorage();
            });
        });

        // ========== äº‹ä»¶ç›‘å¬ï¼šå‘½åè§„èŒƒåˆ‡æ¢ ==========
        nameRuleRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                if (currentCodeType !== 'frontend') return;
                currentNameRule = radio.value;
                const standardRes = standardizeModuleName(moduleRaw);
                if (standardRes.valid) {
                    updateModuleState(standardRes);
                    updateDirTree();
                }
                log(`å·²åˆ‡æ¢å‰ç«¯å‘½åè§„èŒƒï¼š${currentNameRule === 'camel' ? 'å¤§é©¼å³°ï¼ˆPascalCaseï¼‰' : 'çŸ­æ¨ªçº¿ï¼ˆkebab-caseï¼‰'}`, false);
                updateBtnWriteState();
                saveToLocalStorage();
            });
        });

        // ========== äº‹ä»¶ç›‘å¬ï¼šæ¨¡æ¿æ–‡ä»¶Tabåˆ‡æ¢ ==========
        templateFileRadios.forEach(radio => {
            radio.addEventListener('change', () => {
                switchTemplateTab(radio.value);
            });
        });

        // ========== äº‹ä»¶ç›‘å¬ï¼šé€‰æ‹©ç›®å½• ==========
        btnPick.addEventListener('click', async () => {
            try {
                if (!window.showDirectoryPicker) {
                    return log("ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ File System Access APIï¼Œè¯·ä½¿ç”¨Chrome/Edge/Firefoxæœ€æ–°ç‰ˆ", true);
                }
                targetDirHandle = await window.showDirectoryPicker();
                if (currentCodeType === 'frontend' && targetDirHandle.name !== 'src') {
                    log('å‰ç«¯ä»£ç ç”Ÿæˆè¯·é€‰æ‹©é¡¹ç›®çš„srcæ–‡ä»¶å¤¹ï¼', true);
                    targetDirHandle = null;
                    return;
                }
                if (currentCodeType === 'backend') {
                    log(`âœ… å·²è·å–åç«¯é¡¹ç›®æ ¹ç›®å½•æˆæƒï¼Œå°†ä½¿ç”¨ç¼–è¾‘åçš„åŸå§‹æ¨¡æ¿ç”Ÿæˆä»£ç `, false);
                } else {
                    log(`âœ… å·²è·å–å‰ç«¯srcç›®å½•æˆæƒï¼Œå°†ä½¿ç”¨ç¼–è¾‘åçš„åŸå§‹æ¨¡æ¿ç”Ÿæˆä»£ç `, false);
                }
                updateBtnWriteState();
            } catch (err) {
                log(`ç”¨æˆ·å–æ¶ˆæˆ–ç›®å½•é€‰æ‹©å¤±è´¥: ${err.message}`, true);
            }
        });

        // ========== æ ¸å¿ƒï¼šç”Ÿæˆä»£ç ï¼ˆåŸºäºç¼–è¾‘åçš„åŸå§‹æ¨¡æ¿æ¸²æŸ“ï¼‰ ==========
        btnWrite.addEventListener('click', async () => {
            if (!targetDirHandle || !moduleDir) return;
            const codeTypeText = currentCodeType === 'frontend' ? 'å‰ç«¯Vue' : 'åç«¯Java';
            const templateCount = currentCodeType === 'frontend' ? 4 : 6;

            try {
                log(`æ­£åœ¨ç”Ÿæˆã€${moduleCamel}ã€‘æ¨¡å—${codeTypeText}ä»£ç ï¼ˆå…±${templateCount}ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨ç¼–è¾‘åçš„åŸå§‹æ¨¡æ¿ï¼‰...`, false);
                if (currentCodeType === 'frontend') {
                    await generateFrontendCode();
                } else {
                    await generateBackendCode();
                }
                const highlightStr = currentCodeType === 'frontend' ? 'src/' : 'é¡¹ç›®æ ¹ç›®å½•/';
                dirTreeArea.innerHTML = generateDirTree().replace(highlightStr, `<span class="generated">${highlightStr}</span>`);
                saveToLocalStorage();
                log(`âœ… ã€${moduleCamel}ã€‘æ¨¡å—${codeTypeText}ä»£ç ç”ŸæˆæˆåŠŸï¼å…±${templateCount}ä¸ªæ–‡ä»¶ï¼Œå‡ç”±åŸå§‹æ¨¡æ¿æ¸²æŸ“`, false);
            } catch (err) {
                log(`âŒ ä»£ç ç”Ÿæˆå¤±è´¥: ${err.message}`, true);
                console.error(err);
            }
        });

        // ========== å‰ç«¯ä»£ç ç”Ÿæˆï¼ˆåŸºäºåŸå§‹æ¨¡æ¿æ¸²æŸ“ï¼‰ ==========
        async function generateFrontendCode() {
            const apiFile = getFileName('api');
            const routerFile = getFileName('router');
            const indexFile = getFileName('index');
            const modalFile = getFileName('modal');
            // æ¸²æŸ“åŸå§‹æ¨¡æ¿ä¸ºå®é™…ä»£ç 
            const apiContent = renderTemplate(TEMPLATES.frontend.api);
            const routerContent = renderTemplate(TEMPLATES.frontend.router);
            const indexContent = renderTemplate(TEMPLATES.frontend.index);
            const modalContent = renderTemplate(TEMPLATES.frontend.modal);
            // å†™å…¥æ–‡ä»¶
            await writeFile(targetDirHandle, `router/modules/${routerFile}`, routerContent);
            await writeFile(targetDirHandle, `views/${viewFolder}/api/${apiFile}`, apiContent);
            await writeFile(targetDirHandle, `views/${viewFolder}/${indexFile}`, indexContent);
            await writeFile(targetDirHandle, `views/${viewFolder}/comp/${modalFile}`, modalContent);
        }

        // ========== åç«¯ä»£ç ç”Ÿæˆï¼ˆåŸºäºåŸå§‹æ¨¡æ¿æ¸²æŸ“ï¼‰ ==========
        async function generateBackendCode() {
            const entityFile = getFileName('entity');
            const controllerFile = getFileName('controller');
            const serviceFile = getFileName('service');
            const serviceImplFile = getFileName('serviceImpl');
            const mapperFile = getFileName('mapper');
            const xmlFile = getFileName('mapperXml');
            // æ¸²æŸ“åŸå§‹æ¨¡æ¿ä¸ºå®é™…ä»£ç 
            const entityContent = renderTemplate(TEMPLATES.backend.entity);
            const controllerContent = renderTemplate(TEMPLATES.backend.controller);
            const serviceContent = renderTemplate(TEMPLATES.backend.service);
            const serviceImplContent = renderTemplate(TEMPLATES.backend.serviceImpl);
            const mapperContent = renderTemplate(TEMPLATES.backend.mapper);
            const mapperXmlContent = renderTemplate(TEMPLATES.backend.mapperXml);
            // åŸºç¡€è·¯å¾„
            const baseJavaPath = `main/java/com/renren/modular/${moduleLower}`;
            const baseXmlPath = `main/resources/mapper/${moduleLower}`;
            // å†™å…¥æ–‡ä»¶
            await writeFile(targetDirHandle, `${baseJavaPath}/entity/${entityFile}`, entityContent);
            await writeFile(targetDirHandle, `${baseJavaPath}/controller/${controllerFile}`, controllerContent);
            await writeFile(targetDirHandle, `${baseJavaPath}/service/${serviceFile}`, serviceContent);
            await writeFile(targetDirHandle, `${baseJavaPath}/service/impl/${serviceImplFile}`, serviceImplContent);
            await writeFile(targetDirHandle, `${baseJavaPath}/mapper/${mapperFile}`, mapperContent);
            await writeFile(targetDirHandle, `${baseXmlPath}/${xmlFile}`, mapperXmlContent);
        }

        // ========== åŸæœ‰åŠŸèƒ½ï¼šæ–‡ä»¶/ç›®å½•æ“ä½œ ==========
        async function writeFile(dirHandle, path, content) {
            const parts = path.split('/').filter(Boolean);
            const fileName = parts.pop();
            const targetDirHandle = await ensureDir(dirHandle, parts);
            const fileHandle = await targetDirHandle.getFileHandle(fileName, { create: true });
            const writable = await fileHandle.createWritable();
            await writable.write(content);
            await writable.close();
        }

        async function ensureDir(root, pathSegments) {
            let current = root;
            for (const segment of pathSegments) {
                current = await current.getDirectoryHandle(segment, { create: true });
            }
            return current;
        }

        // åˆå§‹åŒ–
        window.addEventListener('load', initFromLocalStorage);
    </script>
</body>
</html>